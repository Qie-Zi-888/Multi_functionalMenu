# Multi_functionalMenu
## 🎯 项目概述

本课程设计是基于 **AT32单片机** 的多功能菜单系统，通过科技手段提升日常生活和工作效率，为用户提供便捷的数字体验。

---

## 🔧 开发环境

- **主控芯片**：AT32F435VGT7
- **操作系统**：FreeRTOS
- **图形库**：LVGL
- **开发工具**：AT32 IDE / Keil
- **调试工具**：串口调试助手
  
---

### 核心功能
- **象棋游戏**：完整的中国象棋对弈功能
- **计算器**：支持基本四则运算
- **日历**：日期显示与切换
- **OLED示波器**：实时波形显示
- **LED控制**：智能照明模拟
- **排序算法可视化**：动态展示冒泡排序过程

---

## 🧱 硬件设计

### 总体架构
```
                    ┌─────────────┐
                    │  AT32F435   │
                    │  主控芯片   │
                    └──────┬──────┘
         ┌─────────┬───────┼───────┬─────────┐
         ▼         ▼       ▼       ▼         ▼
     ┌──────┐ ┌──────┐ ┌──────┐ ┌──────┐ ┌──────┐
     │ LCD  │ │ OLED │ │蜂鸣器│  │ LED │  │ 按键 │
     └──────┘ └──────┘ └──────┘ └──────┘ └──────┘
```

### 主要硬件模块

| 模块 | 型号/规格 | 功能 |
|------|----------|------|
| **主控芯片** | AT32F435VGT7 | Cortex-M4内核，288MHz主频 |
| **LCD模块** | 80并口屏 | 功能界面显示，触摸交互 |
| **OLED模块** | 128×64 | ADC波形显示 |
| **蜂鸣器** | 无源蜂鸣器 | 按键反馈 |
| **LED模块** | - | 智能照明模拟 |

---

## 💻 软件设计

### 系统架构

菜单界面：
<img width="280" height="200" alt="image" src="https://github.com/user-attachments/assets/46d43711-68bd-4138-8b3e-200ffc8208cd" />

基于 **FreeRTOS** 实时操作系统，采用多任务设计：

```
                    ┌─────────────┐
                    │  开始任务    │
                    └──────┬──────┘
         ┌─────────┬───────┼───────┬─────────┐
         ▼         ▼       ▼       ▼         ▼
    ┌───────┐ ┌───────┐ ┌───────┐ ┌───────┐ ┌───────┐
    │ LVGL  │ │ 计算器 │ │ 游戏  │ │按键扫描│ │ 调试  │
    │ 任务  │ │  任务  │ │ 任务  │ │  任务  │ │ 任务  │
    └───────┘ └───────┘ └───────┘ └───────┘ └───────┘
```

---
### 功能模块详解

#### 🎮 象棋游戏
- 完整的中国象棋规则（将、士、象、马、车、炮、兵）
- 走法合法性校验
- "将军"判定与胜负判断
- 10×9棋盘状态管理
<img width="300" height="200" alt="image" src="https://github.com/user-attachments/assets/f3e9f760-3531-48b0-991e-49ac77da4dc6" />

#### 🧮 计算器
- 支持加减乘除四则运算
- 事件驱动架构（LVGL按钮矩阵）
- 自定义字符串转浮点函数（解决atof失效问题）
- 除零错误处理
<img width="300" height="200" alt="image" src="https://github.com/user-attachments/assets/5e57264a-10ab-43db-8d3b-ca166182b0ab" />

#### 📊 OLED示波器
- ADC实时采集电压信号
- 动态波形显示
- 电压数值实时显示
<img width="300" height="200" alt="image" src="https://github.com/user-attachments/assets/bd5dbb3e-3309-403d-9029-b6c5f4325f36" />
<img width="300" height="200" alt="image" src="https://github.com/user-attachments/assets/a907b862-4999-46aa-8df4-ddbf10e4615b" />

#### 💡 LED控制
- 通过Switch控件控制物理LED
- 实时读取GPIO输出状态
<img width="300" height="200" alt="image" src="https://github.com/user-attachments/assets/f1ac48e9-1adb-43c7-809f-bceb0a4a5916" />

#### 🔄 排序算法可视化
- 冒泡排序过程动态展示
- 颜色区分元素状态（未排序/正在比较/已排序）
- LCD矩形条绘制
<img width="300" height="200" alt="image" src="https://github.com/user-attachments/assets/6c3e5239-6179-4fd5-9668-77af018729ff" />

#### 📅 日历模块
- 实时日期显示
- 支持月份/年份切换
<img width="699" height="480" alt="image" src="https://github.com/user-attachments/assets/a26926ee-dae9-4d77-9707-4923eb400909" />

---

## 🧪 系统测试与调试

### 遇到的主要问题及解决

| 问题 | 解决方案 |
|------|----------|
| LVGL界面切换卡死 | 挂起恢复任务，释放控件资源 |
| 计算器atof转换失败 | 手写`string_to_double()`函数 |
| FreeRTOS队列接收卡死 | 改用数组接收，及时清空数据 |
| 游戏触摸事件冲突 | 引入任务挂起策略 |

---

### 项目亮点
- ✅ 六大功能模块集成，交互丰富
- ✅ 任务分工明确，代码可维护性强
- ✅ 解决了多个技术难点（浮点转换、任务冲突等）
- ✅ 界面友好，操作流畅

### 未来展望
- 优化数据接收机制，提升系统稳定性
- 增加更多实用功能（如闹钟、备忘录）
- 改进界面调度策略，提升响应速度

---
